{% load static %}
{% load sass_tags %}
{% load custom_templatetags %}
{% load mathfilters %}

<div class="product-wrapper-grid product">
  <div class="row g-sm-4 g-3">
    {% if page_obj %}
    {% for product in page_obj %}
    <div class="col-xl-3 col-md-4 col-6 col-grid-box">
      <div class="product-box">
        <div class="product-imgbox">
          <div class="product-front">
            <a href="{% url 'left_slidebar' product.variantProduct.id %}">
              <img src="{{product.variantProduct.productImageFront}}" class="img-fluid" alt="product">
            </a>
          </div>
          <div class="product-back">
            <a href="{% url 'left_slidebar' product.variantProduct.id %}">
              <img src="{{product.variantProduct.productImageBack}}" class="img-fluid" alt="product">
            </a>
          </div>
        </div>
        <div class="product-detail detail-center detail-inverse">
          <div class="detail-title">
            <div class="detail-left">
              <div class="rating-star">
                {% if product.variantProduct.productFinalRating|to_int < 5|to_int %}
                {% for x in product.variantProduct.productFinalRating|times %}
                <li>
                  <a class="fa fa-star theme-color" id="productOfStar" href="{% url 'left_slidebar' product.id %}"></a>
                </li>
                {% endfor %}

                {% with number1=5|to_int number2=product.variantProduct.productFinalRating|to_int %}
                {% with number3=number1|sub:number2 %}

                {% for x in number3|times %}
                <li>
                  <i class="fa fa-star"></i>
                </li>
                {% endfor %}

                {% endwith %}
                {% endwith %}


                {% else %}
                <li>
                  <i class="fa fa-star theme-color"></i>
                </li>
                <li>
                  <i class="fa fa-star theme-color"></i>
                </li>
                <li>
                  <i class="fa fa-star theme-color"></i>
                </li>
                <li>
                  <i class="fa fa-star theme-color"></i>
                </li>
                <li>
                  <i class="fa fa-star theme-color"></i>
                </li>
                {% endif %}
              </div>
              <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the
                industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and
                scrambled it to make a type specimen book</p>
              <a href="product-page(left-sidebar).html">
                <h6 class="price-title">
                  {{product.variantProduct.productName}}
                </h6>
              </a>
            </div>
            <div class="detail-right">
              <div class="price">
                {% if product.variantProduct.productType == "Simple" %}
                <h3 class="theme-color m-0">
                  {{""|return_currency_wise_symbol:request}}{{product.variantProduct.product_price_range|return_currency_wise_ammount:request}}
                </h3>
                {% else %}
                <h3 class="theme-color m-0">
                  {{product.variantProduct.product_price_range|return_currency_wise_ammount_range:request}}</h3>
                {% endif %}
              </div>
              <div class="check-price">
                {% if product.variantProduct.productType == "Simple" %}
                <del>{{""|return_currency_wise_symbol:request}}{{product.variantProduct.product_actual_price_range|return_currency_wise_ammount:request}}</del>
                {% else %}
                <del>{{product.variantProduct.product_actual_price_range|return_currency_wise_ammount_range:request}}
                  </=>
                  {% endif %}
              </div>
            </div>
          </div>
          <div class="icon-detail">
            <a href="{% url 'add_to_cart' product.variantProduct.id|return_first_product_variant 1 %}"
              class="add-cartnoty tooltip-top" data-tippy-content="Add to cart">
              <i data-feather="shopping-cart"></i>
            </a>
            <a href="{% url 'add_to_wishlist' product.variantProduct.id|return_first_product_variant %}"
              class="add-to-wish tooltip-top wishlist" data-tippy-content="Add to Wishlist">
              <i data-feather="heart"></i>
            </a>
            <a href="javascript:void(0)"
              onclick="handleQuickView({'productId':'{{product.variantProduct.id}}','productVariantId':'{{product.variantProduct.id|return_first_product_variant}}'})"
              data-bs-toggle="modal" data-bs-target="#quick-view" class="tooltip-top" data-tippy-content="Quick View">
              <i data-feather="eye"></i> </a>
            <a href="{% url 'compare_products' product.variantProduct.id|return_first_product_variant %}"
              class="add-to-compare-list" data-tippy-content="Compare">
              <i data-feather="refresh-cw"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

{% if page_obj.has_other_pages %}
<div class="product-pagination">
  <div class="theme-paggination-block">
    <nav>
      <ul class="pagination">
        {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link" href="{{page_obj.previous_page_number|update_url_parameters:request}}">
            <span>
              <i class="fa fa-angle-left"></i>
            </span>
            <span class="sr-only">Previous</span>
          </a>
        </li>
        {% endif %}

        {% for num in page_obj.paginator.page_range %}
        {% if page_obj.number == num %}
        <li class="current-page page-item">
          <a class="page-link" href="{{num|update_url_parameters:request}}">{{num}}</a>
        </li>
        {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
        <li class="page-item"><a class="page-link" href="{{num|update_url_parameters:request}}">{{num}}</a></li>
        {% endif %}
        {% endfor %}

        {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link" href="{{page_obj.next_page_number|update_url_parameters:request}}">
            <span>
              <i class="fa fa-angle-right"></i>
            </span>
            <span class="sr-only">Next</span>
          </a>
        </li>
        {% endif %}
        {% endif %}
      </ul>
    </nav>
  </div>
</div>
{% else %}
<div class="success-icon">
  <img src="{% static 'assets/images/noproductsfound.png' %}" alt="">
</div>
{% endif %}